---
title: 'Using Organization Slugs in URLs'
description: Learn about using organization slugs in URLs to manage the active Clerk organization.
---

<TutorialHero
  beforeYouStart={[
    {
      title: "Set up a Next.js + Clerk application",
      link: "/docs/quickstarts/nextjs",
      icon: "nextjs",
    },
    {
      title: "Enable organizations for your instance",
      link: "/docs/organizations/overview",
      icon: "globe",
    },
    {
      title: "Examine the complete sample repository on Github",
      link: "https://github.com/clerk/orgs/tree/main/examples/sync-org-with-url",
      icon: "git",
    }
  ]}
>
  - Allow users to choose an organization slug
  - Include an organization slug in your URLs
  - Render organization-specific content
</TutorialHero>

## Introduction

In this guide, you will learn how to include an organization slug in your applications URLs, and
how to see information about the active organization at runtime.

This guide will be written for Next.js applications using App Router.

## Background

With Clerk Organizations, users can create entities that represent their companies within your
application. Users can be members of multiple organizations, but can only have one "active" at
any given time. Clerk automatically sets organizations as active when a user picks an organization
with a pre-built component (e.g. the Organization Switcher), and clerk provides APIs (like
auth() and useAuth()), that let you determine the active organization and render the appropriate
content.

A relatively common practice is to represent organization scoped spaces within an app by prefixing
URLs with an organization slug. For example, imagine a b2b application named "Petstore" that has
two customers, "Acmecorp" and "Widgetco". The application may choose to have urls like:

`https://petstore.example.com/orgs/`<b>`acmecorp`</b>`/dashboard` ⬅ indicates **Acmecorp**'s dashboard
`https://petstore.example.com/orgs/`<b>`widgetco`</b>`/dashboard` ⬅ indicates **Widgetco**'s dashboard

Caution: Think carefully about whether you need to include organization slugs in URLs! Consider:

- Will organization-specific links be more useful for your application than
organization-agnostic links? If most users will only ever be in one organization (that represents
their company), they won't need the organization slug to disambiguate the org when sharing
links with their coworkers. Public documentation, marketing, and third-party blogs are also
made easier if links aren't tied to any specific organization.
- Adding an additional piece of state that indicates the organization will require additional
complexity in your application, as opposed to managing it soley and transparently in the clerk
session.

If your application does need to manage the active organization via the URl though, this guide
will cover the best practices for doing so, specifically for nextjs applications that use
server components.

<Steps>
  ### Defining URL patterns

  To begin with, we'll define which sections of our application are scoped to organizations and
  the personal account. For this example, we'll assume that the prefix "orgs" indicates an organizaiton
  is active, followed by the org slug, and the prefix "me" indicates that the personal account is active.

  | URL | What should be active? | What should be displayed? |
  | - | - | - |
  | `/orgs/acmecorp` | Organization Acmecorp | Acmecorp's home |
  | `/orgs/acmecorp/settings` | Organization Acmecorp | Acmecorp's settings |
  | `/me` | Personal account | Personal home |
  | `/me/settings` | Personal account | Personal settings |

  ### Configuring the Organization Switcher

  The Organization Switcher and Organization List components each have a powerful set of options for
  working with slugs.

  Our application uses the personal account, so we will set hidePersonal to `false` to ensure the personal
  account is selectable. We will also allow our users to customize their organization's URL slug when they
  create their organization initially, so we'll also set `hideSlug` to `false.

  Finally, we'll give the components navigation instructions. If the user selects or creates an organization
  with the slug `acmecorp`, the values of `afterCreateOrganizationUrl` and `afterSelectOrganizationUrl` will
  instruct the component to navigate them to `/orgs/acmecorp`. If the user selects their personal account,
  they will be navigated to `/me` via `afterSelectPersonalUrl`.

  <Tabs items={["<OrganizationSwitcher />", "<OrganizationList />"]}>
    <Tab>
      ```tsx {{ filename: 'app/sidebar.tsx', mark: [6] }}
      import { OrganizationSwitcher } from '@clerk/nextjs'

      export default function Sidebar() {
        return (
          <OrganizationSwitcher
            // prettier-ignore
            hidePersonal={false}
            hideSlug={false}
            afterCreateOrganizationUrl='/orgs/:slug'
            afterSelectOrganizationUrl='/orgs/:slug'
            afterSelectPersonalUrl='/me'
          />
        )
      }
    ```
  </Tab>
    <Tab>
      ```tsx {{ filename: 'app/organization-list/[[...organization-list]]/page.tsx', mark: [6] }}
      import { OrganizationList } from '@clerk/nextjs'

      export default function OrganizationListPage() {
        return (
          <OrganizationList
            // prettier-ignore
            hidePersonal={false}
            hideSlug={false}
            afterCreateOrganizationUrl='/orgs/:slug'
            afterSelectOrganizationUrl='/orgs/:slug'
            afterSelectPersonalUrl='/me'
          />
        )
      }
    ```
  </Tab>
</Tabs>

Note that if you'd prefer to have organization IDs appear in your URL rather than slugs, you can use `:id` instead of
`:slug` with `afterCreateOrganizationUrl` and `afterSelectOrganizationUrl`.

### Using Clerk Middleware to set the active organization

Using ClerkMiddleware, it's possible to tell Clerk which URL patterns indicate that a
specific organization or the user's personal account are active. If clerk detects one
of these patterns in nextjs middleware, and it notices that a different organization is
currently active according to the session, it will activate the indicated organization [1] if
possible.

```tsx {{ filename: 'middleware.ts' }}
import { clerkMiddleware } from '@clerk/nextjs/server'

export default clerkMiddleware((auth, req) => {
  if (isProtectedRoute(req)) auth().protect();
},
  {
    organizationSyncOptions: {
      organizationPatterns: [
        "/orgs/:slug",
        "/orgs/:slug/(.*)",
      ],
      personalAccountPatterns: [
        "/me",
        "/me/(.*)"
      ],
    },
  }
);

export const config = {
  matcher: [
    // Skip Next.js internals and all static files, unless found in search params
    "/((?!_next|[^?]*\\.(?:html?|css|js(?!on)|jpe?g|webp|png|gif|svg|ttf|woff2?|ico|csv|docx?|xlsx?|zip|webmanifest)).*)",
    // Always run for API routes
    "/(api|trpc)(.*)",
  ],
};
```

Note that if you'd prefer to have organization IDs appear in your URL rather than slugs, you can use `:id` instead
of `:slug` in `organizationPatterns` and `personalAccountPatterns`.

### Server Rendered Organization Page

Now we're ready to build an organization-specific landing page.

First, we need to handle the case where the middleware cannot activate the organization based on the URL. This can
happen if no organization with the given slug exists, or if the given user isn't a member of the organization.

When this happens, the middleware will not change the active organization, so whatever organization was previously
active will remain active. To help with troubleshooting, a message will also be emitted by the middleware to the server
log:

> Clerk: Organization activation handshake loop detected. This is likely due to an invalid organization ID or slug.
Skipping organization activation.

It's the ultimate responsibility of the page to ensure that it renders the appropriate content for a given URL, and
to handle the case where the expected organization is not active. In this case, we detect the actual organization slug
as a nextjs [Dynamic Route](https://nextjs.org/docs/pages/building-your-application/routing/dynamic-routes) param, and
compare it to the active organization slug. If they don't match, we render an error message and the OrganizationList
component to allow the user to select a valid organization.


```tsx {{ filename: 'src/app/orgs/[slug]/page.tsx' }}
import { auth } from '@clerk/nextjs/server';
import {OrganizationList} from "@clerk/nextjs";

export default function Home({params}:{
  params: { slug: string }
}) {
  const authObject = auth();
  const orgSlug = authObject.orgSlug

  if (params.slug != orgSlug ) {
    return (
      <>
        <p>Sorry, organization {params.slug} is not valid.</p>
        <OrganizationList
          hidePersonal={false}
          hideSlug={false}
          afterCreateOrganizationUrl='/orgs/:slug'
          afterSelectOrganizationUrl='/orgs/:slug'
          afterSelectPersonalUrl='/me'
        />
      </>
    )
  }

  return (
    <>TODO</>
  )
}
```

### Rendering Organization-specific content

Next, let's render some organization-specific content, including the organization's name. To do this, we'll
[customize the Clerk session token](https://clerk.com/docs/backend-requests/making/custom-session-token) to include
the organization name.

1. Navigate to the [Clerk Dashboard](https://dashboard.clerk.com/last-active?path=sessions).
1. In the navigation sidebar, select **Sessions**.
1. In the **Customize session token** section, select the **Edit** button.
1. In the modal that opens, you can add any claim to your session token that you need. For this guide, add the following:

```json
{
  "org_name": "{{org.name}}"
}
```
1. Select **Save**.

Now, let's render the organization name in our page. We'll use the organization name, and also the organization role,
which is included in the
[default session claims](https://clerk.com/docs/backend-requests/resources/session-tokens#default-session-claims).

```tsx {{ filename: 'src/app/orgs/[slug]/page.tsx' }}
import { auth } from '@clerk/nextjs/server';
import {OrganizationList} from "@clerk/nextjs";

export default function Home({params}:{
  params: { slug: string }
}) {
  const authObject = auth();
  const orgSlug = authObject.orgSlug

  if (params.slug != orgSlug ) {
    return (
      <>
        <p className="pb-8">Sorry, organization {params.slug} is not valid.</p>
        <OrganizationList
          hidePersonal={false}
          hideSlug={false}
          afterCreateOrganizationUrl='/orgs/:slug'
          afterSelectOrganizationUrl='/orgs/:slug'
          afterSelectPersonalUrl='/me'
        />
      </>
    )
  }
  let orgName = authObject.sessionClaims['org_name'] as string

  return (
    <div>
      {orgName && (
        <h2>
          Welcome to organization {orgName}
        </h2>
      )}
      <p>
        Your role in this organization: <span>{authObject.orgRole}</span>
      </p>
    </div>
  )
}
```

### The Personal Account and Client-side Routing

Now let's build the page for the personal account as a nextjs client-side component. This page will be
rendered when the user navigates to `/me`.


</Steps>


--------------------- Footer ---------------------------

[^1] Implementation Note: If clerk realizes a mismatch, it will attempt to resolve it by
using a handshake, wherein it will redirect the browser back to clerk with a request to
activate the given organization. If it's possible to do so, Clerk will respond with a new
session token with the desired organization as active and redirect back to your application.
